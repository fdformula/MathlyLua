<!DOCTYPE html><!-- generated by Lua + Mathly: https://github.com/fdformula/MathlyLua -->
<html>
<head>
 <meta charset="utf-8">
 <title>Mathly Function Animation</title>
 <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
<style>
label {
 display: inline-block;
 width: 10px;
 left: 50px;
 text-align: left;
 vertical-align: middle;
 position: absolute;
 white-space: nowrap;
}
input {
 display: inline-block;
 width: 200px;
 left: 65px;
 vertical-align: middle;
 position: absolute;
}
input:focus {outline: none;}
</style>
</head>
<body>
<div id="mathlyDiv" style="width:500px;height:500px;display:inline-block;top:110px;position:absolute;"></div>
<span id='title' style="width:500px;left:0px;display:block;text-align:center;">&nbsp;</span>
<!-- controls -->
<button type="button" title="Previous value" onclick="mthlymNext(-1)" style="width:48px;left:348px;top:60px;position:absolute">Prev</button>
<button type="button" title="Next value" onclick="mthlymNext(1)" style="width:48px;left:399px;top:60px;position:absolute">Next</button>
<label for="mthlySldrm" style='top:60px;'>m:</label>
<input type="range" id="mthlySldrm" min="1" max="20" value="1" style='left:72px;top:60px;' step="1"></input><span id="mthlySldrmvalue" style="left:293px;top:60px;position:absolute">&nbsp;</span>
<button type="button" title="Previous value" onclick="mthlyaNext(-1)" style="width:48px;left:348px;top:90px;position:absolute">Prev</button>
<button type="button" title="Next value" onclick="mthlyaNext(1)" style="width:48px;left:399px;top:90px;position:absolute">Next</button>
<label for="mthlySldra" style='top:90px;'>a:</label>
<input type="range" id="mthlySldra" min="-10" max="10" value="-10" style='left:72px;top:90px;' step="1"></input><span id="mthlySldravalue" style="left:293px;top:90px;position:absolute">&nbsp;</span>
<button type="button" title="Previous value" onclick="mthlynNext(-1)" style="width:48px;left:348px;top:120px;position:absolute">Prev</button>
<button type="button" title="Next value" onclick="mthlynNext(1)" style="width:48px;left:399px;top:120px;position:absolute">Next</button>
<label for="mthlySldrn" style='top:120px;'>n:</label>
<input type="range" id="mthlySldrn" min="1" max="20" value="1" style='left:72px;top:120px;' step="1"></input><span id="mthlySldrnvalue" style="left:293px;top:120px;position:absolute">&nbsp;</span>
<button type="button" title="Previous value" onclick="mthlybNext(-1)" style="width:48px;left:348px;top:150px;position:absolute">Prev</button>
<button type="button" title="Next value" onclick="mthlybNext(1)" style="width:48px;left:399px;top:150px;position:absolute">Next</button>
<label for="mthlySldrb" style='top:150px;'>b:</label>
<input type="range" id="mthlySldrb" min="-20" max="20" value="-20" style='left:72px;top:150px;' step="1"></input><span id="mthlySldrbvalue" style="left:293px;top:150px;position:absolute">&nbsp;</span>
<span id="displaytext" style="left:74px;top:180px;position:absolute">&nbsp;</span>
<script type="text/javascript">
function displaytext() { return ""; } // to be overwritten
function displaytitle() { return ""; }
var x = [], t = [], X, Y, T, p;
function mthlymNext(d) {
  let x = m + d*mthlymStep;
  if (x < mthlymMin) {
    x = mthlymMax;
  } else if (x > mthlymMax) {
    x = mthlymMin;
  }
  x = Math.round(x * 1000) / 1000;
  mthlySldrm.value = x;
  document.getElementById("mthlySldrmvalue").innerHTML = x;
}
function mthlyaNext(d) {
  let x = a + d*mthlyaStep;
  if (x < mthlyaMin) {
    x = mthlyaMax;
  } else if (x > mthlyaMax) {
    x = mthlyaMin;
  }
  x = Math.round(x * 1000) / 1000;
  mthlySldra.value = x;
  document.getElementById("mthlySldravalue").innerHTML = x;
}
function mthlynNext(d) {
  let x = n + d*mthlynStep;
  if (x < mthlynMin) {
    x = mthlynMax;
  } else if (x > mthlynMax) {
    x = mthlynMin;
  }
  x = Math.round(x * 1000) / 1000;
  mthlySldrn.value = x;
  document.getElementById("mthlySldrnvalue").innerHTML = x;
}
function mthlybNext(d) {
  let x = b + d*mthlybStep;
  if (x < mthlybMin) {
    x = mthlybMax;
  } else if (x > mthlybMax) {
    x = mthlybMin;
  }
  x = Math.round(x * 1000) / 1000;
  mthlySldrb.value = x;
  document.getElementById("mthlySldrbvalue").innerHTML = x;
}

const mthlyLayout = {
  xaxis: { range: [-4, 4]}, // plot with fixed axes
  yaxis: { range: [-4, 4], scaleanchor: 'x', scaleratio: 1 },
  showlegend: false
};

var mthlySldrm = document.getElementById('mthlySldrm');
var mthlySldra = document.getElementById('mthlySldra');
var mthlySldrn = document.getElementById('mthlySldrn');
var mthlySldrb = document.getElementById('mthlySldrb');
mthlySldrm.value = 2;
var m = 2;
mthlySldra.value = 8;
var a = 8;
mthlySldrn.value = 2;
var n = 2;
mthlySldrb.value = -13;
var b = -13;
p = 1;
for (let i = 0; i <= p * (6.2831853071796 + 0) - 0; i += 0.0031415926535898) { t.push(i); }

var mthlyTraces = [];
const mthlyxMin = -4, mthlyxMax = 4, mthlyxStep = 1;
const mthlyyMin = -4, mthlyyMax = 4;
const mthlytMin = 0, mthlytMax = 6.2831853071796, mthlytStep = 0.01;
const mthlymMin = 1, mthlymMax = 20, mthlymStep = 1;
const mthlyaMin = -10, mthlyaMax = 10, mthlyaStep = 1;
const mthlynMin = 1, mthlynMax = 20, mthlynStep = 1;
const mthlybMin = -20, mthlybMax = 20, mthlybStep = 1;

function mthlyUpdateTraces() {
  mthlyTraces = [];
  mthlyTraces.push({ x: t.map(t => Math.cos(t) + 1/m * Math.cos(a*t) + 1/n * Math.cos(b*t+3.1416/2)), y: t.map(t => Math.sin(t) + 1/m * Math.sin(a*t) + 1/n * Math.sin(b*t+3.1416/2)), mode: 'lines', line: { simplify: false }, fill: 'none' });
  document.getElementById("displaytext").innerHTML = displaytext();
  document.getElementById("title").innerHTML = displaytitle();
}

mthlyUpdateTraces();
const mthlyInitData = mthlyTraces;

var mthlyNewCs = [], mthlyOldCs = [99999999, 99999999, 99999999, 99999999];

function mthlyAnimatePlot() {
  m = Number(mthlySldrm.value);
  a = Number(mthlySldra.value);
  n = Number(mthlySldrn.value);
  b = Number(mthlySldrb.value);
  // has any controls changed?
  mthlyNewCs = [m, a, n, b];
  var unchangedq = true;
  for (let i = 0; i < 4; i++) {
    if (Math.abs(mthlyOldCs[i] - mthlyNewCs[i]) > 0.00001) {
      unchangedq = false; break;
    }
  }
  if (unchangedq) { return; }
  mthlyOldCs = [m, a, n, b]; // update values of controls
  mthlyUpdateTraces();
  Plotly.animate('mathlyDiv', {
    data: mthlyTraces,
    traces: mthlyTraces.keys() // update all traces
  }, {
    transition: { duration: 0 },
    frame: { duration: 0 }
  });
}

document.getElementById("mthlySldrmvalue").innerHTML = mthlySldrm.value;
mthlySldrm.addEventListener("input", function() { document.getElementById("mthlySldrmvalue").innerHTML = mthlySldrm.value; });
document.getElementById("mthlySldravalue").innerHTML = mthlySldra.value;
mthlySldra.addEventListener("input", function() { document.getElementById("mthlySldravalue").innerHTML = mthlySldra.value; });
document.getElementById("mthlySldrnvalue").innerHTML = mthlySldrn.value;
mthlySldrn.addEventListener("input", function() { document.getElementById("mthlySldrnvalue").innerHTML = mthlySldrn.value; });
document.getElementById("mthlySldrbvalue").innerHTML = mthlySldrb.value;
mthlySldrb.addEventListener("input", function() { document.getElementById("mthlySldrbvalue").innerHTML = mthlySldrb.value; });

Plotly.newPlot('mathlyDiv', mthlyInitData, mthlyLayout);
mthlyAnimatePlot();
mthlyIntervalId = setInterval(mthlyAnimatePlot, 200); // animate every 0.2 seconds
</script>
</body>
</html>
